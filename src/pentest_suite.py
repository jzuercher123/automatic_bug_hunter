from configuration import Configuration
from target_management import Scan


class PentestSuite:
    def __init__(self):
        self.configuration = Configuration()
        self.targets = []
        self.modules = []
        self.reports = []

    def add_target(self, target):
        self.targets.append(target)

    def add_module(self, module):
        self.modules.append(module)

    def run_scan(self, target, module):
        scan = Scan(target, module)
        scan.start_scan()
        self.reports.append(scan)

    def generate_report(self):
        for report in self.reports:
            print(report)

    def run(self):
        for target in self.targets:
            for module in self.modules:
                self.run_scan(target, module)
        self.generate_report()
